#!/usr/bin/env php
<?php
/*
Command: vendors
Pass through for running `composer` that automatically installs it if it isn't installed.  'bin/vendors' was in early versions of Symfony before 'composer' was in use.

Arguments:
	{see composer}
*/
//--install composer if not installed
$whichComposerResult = shell_exec("which composer");
$haveGlobalComposer = (empty($whichComposerResult)) ? false : true;
if(!$haveGlobalComposer){
	$haveLocalComposer = file_exists('composer.phar');
}
$haveComposer = $haveGlobalComposer || $haveLocalComposer;
if(!$haveComposer){
	passthru(__DIR__ . '/installComposer');
	$isRoot = (posix_getuid() === 0);
	if($isRoot){
		$haveGlobalComposer = true;
	}
}

//--gather arguments
$arguments = '';
for($i = 1; $i < $argc; ++$i){
	$arguments .= " {$argv[$i]}";
}

//--run composer with arguments
$composerCommand = ($haveGlobalComposer) ? 'composer' : 'php composer.phar';
passthru($composerCommand . $arguments);
